Distance part done (not tested)